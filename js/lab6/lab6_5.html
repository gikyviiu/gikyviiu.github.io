<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Модальное окно с формой</title>

</head>
<body>

    <template id="prompt-template">
        <div class="prompt-container">
          <div class="prompt-form">
            <div class="prompt-message"></div>
            <input type="text" class="prompt-input" />
            <div class="prompt-buttons">
              <button type="button" class="prompt-ok-button">OK</button>
              <button type="button" class="prompt-cancel-button">Отмена</button>
            </div>
          </div>
        </div>
      </template>
      
      <script>
        (function () {
          const promptTemplate = document.getElementById('prompt-template');
      
          /*
           * Отображает модальную форму с сообщением и полем ввода.
           * @param {string} html Сообщение в форме HTML.
           * @param {function(string|null)} callback Функция обратного вызова, вызываемая после ввода пользователем.
           */
          function showPrompt(html, callback) {
            // Создаем копию шаблона формы.
            const promptForm = promptTemplate.content.cloneNode(true);
      
            // Заполняем сообщение.
            const messageElement = promptForm.querySelector('.prompt-message');
            messageElement.innerHTML = html;
      
            // Добавляем обработчики событий на элементы формы.
            const inputElement = promptForm.querySelector('.prompt-input');
            const okButtonElement = promptForm.querySelector('.prompt-ok-button');
            const cancelButtonElement = promptForm.querySelector('.prompt-cancel-button');
      
            okButtonElement.addEventListener('click', () => {
              callback(inputElement.value);
              closePrompt();
            });
      
            cancelButtonElement.addEventListener('click', () => {
              callback(null);
              closePrompt();
            });
      
            inputElement.addEventListener('keydown', (event) => {
              // Переключаем фокус между полями формы с помощью Tab/Shift+Tab.
              if (event.key === 'Tab') {
                if (event.shiftKey) {
                  cancelButtonElement.focus();
                } else {
                  okButtonElement.focus();
                }
                event.preventDefault();
              }
      
              // Вызываем функцию обратного вызова при нажатии Enter.
              if (event.key === 'Enter') {
                callback(inputElement.value);
                closePrompt();
              }
            });
      
            // Вызываем функцию обратного вызова при нажатии Esc.
            window.addEventListener('keydown', (event) => {
              if (event.key === 'Escape') {
                callback(null);
                closePrompt();
              }
            });
      
            // Помещаем форму в центр окна.
            const promptContainerElement = promptForm.querySelector('.prompt-container');
            centerElement(promptContainerElement);
      
            // Отображаем форму.
            document.body.appendChild(promptForm);
      
            // Устанавливаем фокус на поле ввода.
            inputElement.focus();
      
            // Функция для закрытия формы.
            function closePrompt() {
              document.body.removeChild(promptForm);
              removeEventListeners();
            }
      
            // Функция для удаления обработчиков событий со всех элементов формы.
            function removeEventListeners() {
              okButtonElement.removeEventListener('click', okButtonEventHandler);
              cancelButtonElement.removeEventListener('click', cancelButtonEventHandler);
              inputElement.removeEventListener('keydown', inputKeydownEventHandler);
              window.removeEventListener('keydown', windowKeydownEventHandler);
            }
          }
      
          // Функция для центрирования элемента в окне.
          function centerElement(element) {
            const { width, height } = element.getBoundingClientRect();
            const left = (window.innerWidth - width) / 2;
            const top = (window.innerHeight - height) / 2;
            element.style.left = ${left}px;
            element.style.top = ${top}px;
          }
      
          // Определяем функцию showPrompt глобально.
          window.showPrompt = showPrompt;
        })();

        showPrompt("Введите что-нибудь<br>... умное:)", function(value) {
  alert(value);
});
      </script>
      


</script>
</body>
</html>
